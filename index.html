<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>üí•nig bomb üí•</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* --- CORE CHAOS --- */
        body {
            margin: 0;
            background-color: #000;
            overflow: hidden;
            font-family: 'Impact', sans-serif;
            color: lime;
            cursor: crosshair;
        }

        /* BACKGROUND IMAGES (Pizza, Toilet, Illuminati) */
        .bg-layer {
            position: absolute;
            top: 0; left: 0; width: 100vw; height: 100vh;
            background-image: 
                url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100"><text y="50" font-size="50">üçï</text></svg>'),
                url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100"><text y="50" font-size="50">üöΩ</text></svg>'),
                url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100"><text y="50" font-size="50">üëÅÔ∏è</text></svg>');
            background-repeat: space;
            opacity: 0.3;
            z-index: -1;
            animation: bg-spin 10s linear infinite;
        }

        @keyframes bg-spin {
            0% { transform: scale(1); filter: hue-rotate(0deg); }
            50% { transform: scale(1.5); filter: hue-rotate(180deg); }
            100% { transform: scale(1); filter: hue-rotate(360deg); }
        }

        /* CRT EFFECT */
        .scanlines {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%);
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 900;
        }

        /* THE R6 FLASHBANG IMAGE */
        #flashbang-img {
            position: fixed;
            bottom: -200px;
            right: -200px;
            width: 150px;
            height: auto;
            z-index: 1500;
            display: none; /* Hidden until thrown */
        }
        
        /* Animation for throwing the flash */
        @keyframes throw-arc {
            0% { bottom: -100px; right: -100px; transform: rotate(0deg) scale(0.5); }
            50% { bottom: 50%; right: 50%; transform: rotate(-720deg) scale(1.5); }
            100% { bottom: 50%; right: 50%; transform: rotate(-1000deg) scale(1.5); }
        }

        /* THE WHITE SCREEN OF DEATH */
        #flash-overlay {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: white;
            opacity: 0;
            pointer-events: none;
            z-index: 2000;
        }
        
        .blind {
            animation: blind-anim 3s ease-out forwards;
        }
        @keyframes blind-anim {
            0% { opacity: 1; }
            10% { opacity: 1; background: white; }
            100% { opacity: 0; }
        }

        /* UI CONTAINERS */
        .container {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            height: 100vh; width: 100vw; text-align: center;
            z-index: 10; position: relative;
        }

        h1 { font-size: 5rem; text-shadow: 5px 5px 0px red; letter-spacing: 5px; margin: 0; }
        
        .btn {
            background: red; border: 5px solid yellow; color: white;
            font-size: 2rem; padding: 20px 40px; font-family: 'Impact';
            cursor: pointer; box-shadow: 10px 10px 0px blue;
            transition: transform 0.1s;
        }
        .btn:active { transform: scale(0.95); }

        .hidden { display: none !important; }

        /* QUIZ STYLES */
        .quiz-btn {
            display: block; width: 60%; margin: 10px auto;
            background: blue; color: white; font-size: 2rem; border: 2px solid white;
        }
        .quiz-btn:hover { background: gold; color: black; }

    </style>
</head>
<body>

    <div class="bg-layer"></div>
    <div class="scanlines"></div>
    <div id="flash-overlay"></div>

    <img id="flashbang-img" src="data:image/svg+xml;utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 200'%3E%3Crect x='30' y='40' width='40' height='120' rx='10' fill='%23555' stroke='black' stroke-width='3'/%3E%3Crect x='25' y='30' width='50' height='10' fill='silver' stroke='black'/%3E%3Ccircle cx='70' cy='35' r='10' fill='none' stroke='silver' stroke-width='3'/%3E%3Crect x='30' y='60' width='40' height='5' fill='red'/%3E%3Ctext x='35' y='120' fill='white' font-family='Arial' font-size='10' font-weight='bold'%3EM84%3C/text%3E%3C/svg%3E" alt="Flashbang">

    <div id="intro" class="container">
        <h1>TACTICAL<br>BRAINROT<br>OPS</h1>
        <p style="font-size: 1.5rem; background: black;">üîä CLICK START TO ENABLE AUDIO üîä</p>
        <button class="btn" onclick="initSite()">DEPLOY TO OHIO</button>
    </div>

    <div id="game-ui" class="container hidden">
        <h2 style="background:black;">DODGE THE SPIKES (TAP/SPACE)</h2>
        <canvas id="game-canvas" width="600" height="300" style="background:#222; border: 5px solid lime; box-shadow: 0 0 20px red;"></canvas>
        <h3 id="score" style="background:black;">SCORE: 0</h3>
    </div>

    <div id="quiz-ui" class="container hidden">
        <h1 style="font-size: 3rem;">THE INTERROGATION</h1>
        <h2 id="q-text" style="background: black; padding: 10px;">LOADING...</h2>
        <div id="q-opts" style="width: 100%;"></div>
    </div>

    <div id="outro" class="container hidden">
        <h1 class="spin-text" style="color: yellow; font-size: 6rem;">MISSION PASSED</h1>
        <div style="font-size: 3rem; font-weight: bold; line-height: 1.5; text-shadow: 3px 3px 0 black;">
            <div id="txt1">üçï EAT PIZZA</div>
            <div id="txt2">üò¥ SLEEP</div>
            <div id="txt3" style="color: red; font-size: 5rem;">üëπ GOON</div>
            <div id="txt4">üîÅ REPEAT</div>
        </div>
        <button class="btn" onclick="location.reload()" style="margin-top:20px;">RE-FLASH</button>
    </div>

    <script>
        // --- AUDIO ENGINE (OSCILLATORS FOR RELIABILITY) ---
        let audioCtx;
        
        function initAudio() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }
            if (audioCtx.state === 'suspended') {
                audioCtx.resume();
            }
        }

        // 1. FLASHBANG SOUND (White Noise + Tinnitus Ring)
        function soundBang() {
            const t = audioCtx.currentTime;
            
            // Explosion (White Noise)
            const bufferSize = audioCtx.sampleRate * 2; // 2 seconds
            const buffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
            const data = buffer.getChannelData(0);
            for (let i = 0; i < bufferSize; i++) data[i] = Math.random() * 2 - 1;

            const noise = audioCtx.createBufferSource();
            noise.buffer = buffer;
            const noiseGain = audioCtx.createGain();
            noiseGain.gain.setValueAtTime(1, t);
            noiseGain.gain.exponentialRampToValueAtTime(0.01, t + 1);
            
            noise.connect(noiseGain);
            noiseGain.connect(audioCtx.destination);
            noise.start();

            // Tinnitus Ring (High Pitch Sine)
            const osc = audioCtx.createOscillator();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(2500, t); // 2500Hz ear ringing
            const oscGain = audioCtx.createGain();
            oscGain.gain.setValueAtTime(0.1, t);
            oscGain.gain.linearRampToValueAtTime(0.3, t + 0.1);
            oscGain.gain.exponentialRampToValueAtTime(0.01, t + 4); // Rings for 4 seconds

            osc.connect(oscGain);
            oscGain.connect(audioCtx.destination);
            osc.start();
            osc.stop(t + 4);
        }

        // 2. JUMP SOUND
        function soundJump() {
            const osc = audioCtx.createOscillator();
            const g = audioCtx.createGain();
            osc.type = 'square';
            osc.frequency.setValueAtTime(150, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(600, audioCtx.currentTime + 0.1);
            g.gain.setValueAtTime(0.1, audioCtx.currentTime);
            g.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
            osc.connect(g); g.connect(audioCtx.destination);
            osc.start(); osc.stop(audioCtx.currentTime + 0.1);
        }

        // 3. VOICE (TTS)
        function speak(text) {
            window.speechSynthesis.cancel();
            const u = new SpeechSynthesisUtterance(text);
            u.rate = 1.3; u.pitch = 0.8; u.volume = 1;
            window.speechSynthesis.speak(u);
        }

        // --- FLASHBANG ANIMATION LOGIC ---
        function throwFlashbang(callback) {
            const img = document.getElementById('flashbang-img');
            const overlay = document.getElementById('flash-overlay');
            
            // 1. Play "Pin Pull" sound (short hiss)
            const osc = audioCtx.createOscillator();
            const g = audioCtx.createGain();
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(800, audioCtx.currentTime);
            g.gain.setValueAtTime(0.1, audioCtx.currentTime);
            g.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.1);
            osc.connect(g); g.connect(audioCtx.destination);
            osc.start(); osc.stop(audioCtx.currentTime + 0.1);

            // 2. Animate Image
            img.style.display = 'block';
            img.style.animation = 'throw-arc 1.5s ease-in forwards';

            // 3. Detonate after animation
            setTimeout(() => {
                img.style.display = 'none'; // Hide grenade
                soundBang(); // Play loud noise
                overlay.classList.add('blind'); // Turn screen white
                
                // Remove white screen class after animation
                setTimeout(() => {
                    overlay.classList.remove('blind');
                    if(callback) callback();
                }, 3000); // 3 seconds blind
            }, 1500);
        }

        // --- GAME LOGIC ---
        function initSite() {
            initAudio(); // UNLOCK SOUNDS
            speak("Tactical Nuke Incoming. Good luck.");
            document.getElementById('intro').classList.add('hidden');
            document.getElementById('game-ui').classList.remove('hidden');
            startGame();
        }

        // Simple Geo Dash Clone
        let player = {y:250, dy:0, grounded:true};
        let obstacles = [];
        let score = 0;
        let gameActive = false;
        let canvas, ctx;

        function startGame() {
            canvas = document.getElementById('game-canvas');
            ctx = canvas.getContext('2d');
            gameActive = true;
            document.body.onkeydown = (e) => { if(e.code==='Space') jump(); }
            document.body.ontouchstart = jump;
            document.body.onclick = jump; // Any click jumps
            gameLoop();
        }

        function jump() {
            if(player.grounded) {
                player.dy = -15; player.grounded = false;
                soundJump();
            }
        }

        function gameLoop() {
            if(!gameActive) return;
            requestAnimationFrame(gameLoop);
            
            ctx.clearRect(0,0,600,300);
            
            // Physics
            player.dy += 1; // Gravity
            player.y += player.dy;
            if(player.y > 250) { player.y = 250; player.grounded = true; }

            // Draw Player (Yellow Box)
            ctx.fillStyle = 'yellow'; ctx.fillRect(50, player.y, 40, 40);
            ctx.fillStyle = 'black'; ctx.fillRect(70, player.y+10, 10, 10); // sunglasses

            // Spikes
            if(Math.random() < 0.02) obstacles.push({x:600, type:'spike'});
            
            obstacles.forEach((obs, i) => {
                obs.x -= 8; // Speed
                ctx.fillStyle = 'red';
                ctx.beginPath(); 
                ctx.moveTo(obs.x, 290); ctx.lineTo(obs.x+20, 250); ctx.lineTo(obs.x+40, 290); 
                ctx.fill();

                // Collision
                if(obs.x < 90 && obs.x > 10 && player.y > 210) {
                    // HIT SPIKE -> FLASHBANG PUNISHMENT
                    gameActive = false;
                    speak("You are trash. Get flashed.");
                    throwFlashbang(() => {
                        // Restart game after flash
                        obstacles = []; score = 0; gameActive = true; gameLoop();
                    });
                }
            });

            obstacles = obstacles.filter(o => o.x > -50);
            
            score++;
            document.getElementById('score').innerText = "SCORE: " + score;

            if(score > 500) {
                gameActive = false;
                speak("Level Complete. Engaging Quiz.");
                document.getElementById('game-ui').classList.add('hidden');
                initQuiz();
            }
        }

        // --- QUIZ LOGIC ---
        const qs = [
            {q: "DOES PINEAPPLE BELONG ON PIZZA?", a: ["YES", "NO", "ONLY IN OHIO"], c: 1},
            {q: "COMPLETE: SKIBIDI ____", a: ["BOP", "TOILET", "RIZZ"], c: 1}
        ];
        let qIdx = 0;

        function initQuiz() {
            document.getElementById('quiz-ui').classList.remove('hidden');
            loadQ();
        }

        function loadQ() {
            if(qIdx >= qs.length) { doOutro(); return; }
            let d = qs[qIdx];
            document.getElementById('q-text').innerText = d.q;
            speak(d.q);
            let h = "";
            d.a.forEach((opt, i) => {
                h += `<button class='quiz-btn' onclick='check(${i}, ${d.c})'>${opt}</button>`;
            });
            document.getElementById('q-opts').innerHTML = h;
        }

        function check(i, c) {
            if(i === c) {
                speak("Correct.");
                qIdx++; loadQ();
            } else {
                speak("WRONG.");
                throwFlashbang(); // Punishment
            }
        }

        function doOutro() {
            document.getElementById('quiz-ui').classList.add('hidden');
            document.getElementById('outro').classList.remove('hidden');
            
            const words = ["Eat Pizza", "Sleep", "Goon", "Repeat"];
            let i = 0;
            setInterval(() => {
                speak(words[i]);
                document.body.style.filter = `hue-rotate(${Math.random()*360}deg)`;
                i = (i+1)%4;
            }, 1000);
        }

    </script>
</body>
</html>
